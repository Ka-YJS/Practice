# SQL기초

## CREATE문(DDL)

1. 데이터베이스와 테이블(릴레이션)을 제작하는 SQL
2. 작성예시 : CREATE DATABASE DBNAME;
```SQL
CREATE TABLE TABLE_NAME(
    column_name1, data_type(size)
    column_name2, data_type(size)
    column_name3, data_type(size)
);
```
- TABLE_NAME : TABLE_NAME
- column_name : 속성(애트리뷰트)의 이름
- data_type(size) : 속성(애트리뷰트)에 있는 데이터의 타입을 명시함(ex. VARCHAR, INT 등)

### 제약조건이란?

1. 제약조건 : 테이블에 문제가 되는 결함이 있는 데이터가 입력되지 않도록 미리 지정해둔 조건임
2. 제약조건은 테이블을 생성할 때 함께 설정할 수 있고, 추후에 생성하거나 변경할 수 도 있음
3. NOT NULL : 
    - 형식 : 
	```SQL    
        column_name data_type NOT NULL;
    ```
    - 컬럼을 정의할 때 NOT NULL 제약조건을 명시하면 해당 컬럼에는 반드 데이터를 입력해야 함
    - 즉 반드시 값이 들어 있어야 하는 컬럼에는 NOT NULL제약조건을 만들어 사용함
4. UNIQUE
    - 형식 :
    ```SQL 
	column_name data_type UNIQUE;
	
	CONSTRAINTS 제약조건명 UNIQUE(column_name,...);
    ```
    - 해당 컬럼에 들어가는 값이 유일해야 한다는 의미임 -> 즉, 중복되는 값을 허용하지 않음
    - NOT NULL을 같이 명시하면 해당 컬럼에 들어오는 값은 유일함은 물론 반드시 입력해야 함
5. NULL
    - 형식 : 
    ```SQL
    컬럼명 IS NULL --컬럼 값이 NULL이면 참
	컬럼명 IS NOT NULL --컬럼 값이 NULL이 아니면 참
    ```

### PRIMARY KEY와 FOREIGN KEY

- 테이블과 테이블사이를 연결해주는게 PRIMARY KEY(기본키)와 FOREIGN KEY(외래키)임

#### PRIMARY KEY(기본키)

1. 기본키는 UNIQUE와 NOT NULL 속성을 동시에 가진 제약조건으로, 테이블 당 1개의 기본키만 생성할 수 있음(기본키는 다른 항목과 절대로 중복되어 나타날 수 없는 단일 값)
2. 기본 키는 절대로 NULL상태가 될 수 없음
3. 보통 테이블에 키를 생성했다라고 할 때, 이는 기본키를 의미함
4. ex. 주민등록번호 -> 동일번호 불가능, 모두 다 있음
5. 형식
```SQL
    column_name data_type PRIMARY KEY;
    CONSTRAINTS 제약조건명 PRIMARY KEY(column_name...);
```

#### FOREIGN KEY(외래키)

1. 두 개의 테이블을 연결해주는 다리역할
2. 새롭게 추가되는 데이터(튜플)에서 외래 키에 해당하는 값이 참조하는 테이블에 존재하는지 체크
3. ex. 주문데이터를 넣으려고하는데, 회원테이블에서 아직 가입하지않은 아이디일 때 오류
4. 형식
```SQL
    CONSTRAINT 외래키명 FOREIGN KEY(column_name, ...) REFERENCES 참조 테이블(참조 테이블 column_name, ...);
```
5. 외래키예시
    - 부서의 정보는 부서테이블에 저장이 되어있고, 사원 테이블에는 부서번호만 저장을 했을때 신입사원이 입사했을 때 잘못된 부서번호를 입력하는 오류를 범할 수 있음
    - 외래키를 설정해놓으면 부서정보에 없는 부서번호를 입력하려고 할 때 오라클은 오류를 발생시켜 잘못된 데이터가 입력되는 것을 방지함
    - 삭제에서도 마찬가지임. 사원이 있는 부서가 있을 때는 부서의 정보를 삭제할 수 없음
6. 외래키 제약사항
    - 반드시 참조하는 테이블이 먼저 생성되어야 하며, 참조키가 참조 테이블의 기본키로 만들어져 있어야 함
    - 외래키에 사용할 수 있는 컬럼 개수는 최대 32개임
    - 여러 컬럼을 외래키로 만들려면, 참조하는 컬럼과 외래키 컬럼의 순서와 개수는 같아야 함

#### 무결성

1. 데이터베이스에 저장된 데이터 값과 그것이 표현하는 현실 세계의 실제값이 일치하는지 정확성을 의미함
2. 무결성 제약조건은 DB에 들어있는 데이터의 정확성을 보장하기 위해 부정확한 자료가 DB내에 저장되는 것을 방지하기 위한 제약조건을 말함
3. 데이터의 정확성, 일관성, 유효성이 유지되는 것, 일관된 데이터베이스 상태를 정의하는 규칙을 묵시적으로 또는 명시적으로 정의함
    - 정확성 : 중복이나 누락이 없는 형태
    - 일관성 : 원인과 결과의 의미가 연속적으로 보장되어 변하지 않는 상태
    - 유효성 : 사용자로부터 값을 입력받을 때 정확한 값만 입력되도록 할 때 유효한 기능임
4. 개체 무결성 : PK로 선택된 컬럼은 고유한 값을 가져야 하며, 빈 값, NULL값은 허용하지 않음
5. 참조 무결성
    - 외래키 값은 Null 이거나 참조 테이블의 기본키 값과 동일해야 함
    - 즉, 테이블은 참조할 수 없는 외래키 값을 가질 수 없다는 규정임
    - 예시 : <수강> 테이블의 '학번' 속성에는 <학생> 테이블의 '학번'속성에 없는 값은 입력할 수 없음
6. 도메인 무결성(도메인 : 하나의 속성이 가질 수 있는 데이터의 집합 ex.성별{ 남 : 여 })
    - 주어진 속성의 값들이 도메인에 속한 값이어야 한다는 규정임
    - 예시 : <수강> 이라는 테이블에 '과목명'이라는 속성에 영어,수학, 국어 세 가지만 입력되도록 유효한 값을 가지는 경우 반드시 해당 값만 입력을 해야 함
    - 사용자 정의 무결성 : 속성 값들이 사용자가 정의한 제약 조건에 만족해야 한다는 규정임

### CHECK와 DEFAULT

1. CHECK
    - 컬럼에 입력되는 데이터를 체크해 특정 조건에 맞는 데이터만 입력받고 그렇지 않으면 오류를 냄
    - 형식
    ```SQL
    CONSTRAINT 체크명 CHECK(체크조건);
    ```
2. DEFAULT
    - 아무것도 입력하지 않으면 설정한 기본값이 입력됨 -> 값이 입력되면 기본 값은 무시됨
    - 형식
    ```SQL
    column_name data_type DEFAULT 값;
    ```

### NOT NULL과 DEFAULT의 차이점

```SQL
-- ex)GENDER CHAR(1) DEFAULT 'W'

	/* QUERY 1*/
	INSERT INTO TBL_STUDENT GENDER VALUES (NULL);

	/* QUERY 2*/
	INSERT INTO TBL_STUDENT GENDER VALUES ();
```
1. QUERY 1 : 'NULL'이라는 특정한 값을 받았다고 생각하기 때문에 아무일도 일어나지 않음
->DEFAULT 값이 안들어감, 오류X
2. QUERY 2 : 쿼리2는 아무런 입력도 받지 않았다고 생각하기 때문에 DEFAULT값은 'W'으로 설정됨
3. NOT NULL만 선언한 경우
    - QUERY 1 : 해당 컬럼에 아무값도 넣지 않고 INSERT했을 때 -> NOT NULL 동작함
    - QUERY 2 : 해당 컬럼에 NULL값을 넣어 INSERT했을 때 -> NOT NULL 동작함
4. DEFAULT만 선언한 경우
    - QUERY 1 : 해당 컬럼에 아무값도 넣지 않고 INSERT했을 때 -> DEFAULT 동작
    - QUERY 2 : 해당 컬럼에 NULL값을 넣어 INSERT했을 때 -> DEFAULT 동작하지 않음
    -> NULL이라는 값이 들어간 것으로 취급하여, DEFAULT값이 들어가지 않음
5. NOT NULL과 DEFAULT 둘 다 선언한 경우
    - QUERY 1 : 해당 컬럼에 아무값도 넣지 않고 INSERT했을 때 -> DEFAULT 동작하여 기본값 들어감
    - QUERY 2 : 해당 컬럼에 NULL값을 넣어 INSERT했을 때 -> NOT NULL 동작


## ALTER문(DDL)

1. 테이블을 수정할 때 사용하는 구문
2. 컬럼(속성)을 추가 및 삭제, 변경 가능함
3. 형식 : 
```SQL
ALTER TABLE TABLE_NAME DROP column City;
ALTER TABLE TABLE_NAME ADD Sample VARCHAR(20);
ALTER TABLE 'SAMPLE_TABLE' RENAME column 'Sample1' to 'Sample2';
ALTER TABLE 'SAMPLE_TABLE' MODIFY column 'Sample1' to 'INT';
ALTER TABLE 'SAMPLE_TABLE' CHANGE column 'Sample1' 'Sample2' 'INT';
ALTER TABLE 'SAMPLE_TABLE' RENAME TO 'SAMPLE_TABLE2';
ALTER TABLE 'SAMPLE_TABLE' DROP PRIMARY KEY;
ALTER TABLE 'SAMPLE_TABLE' ADD PRIMARY KEY('Sample1');
```
- 위에서부터 삭제, 추가, 이름변경, 데이터타입변경, column_name과 데이터타입변경, 테이블이름변경, 기본키삭제, 새로운 기본키지정의 예시임
4. 사용예시
```SQL
CREATE TABLE T6(C1 INT, C2 VARCHAR(10));

ALTER TABLE T6 DROP column c2; -> T6테이블에서 C2속성 삭제
ALTER TABLE T6 ADD column c3 INT; -> T6테이블에서 C3속성 추가
ALTER TABLE T6 ADD column c4 INT NOT NULL; -> T6테이블에서 C4속성 추가+옵션부여
```

## DROP문(DDL)

1. 데이터베이스를 삭제하거나 테이블을 삭제하는 용도임
2. 형식
```SQL
DROP DATABASE TABLE_NAME;
DROP TABLE TABLE_NAME;
```

## DML

1. DML(Data Manipulation Language)는 데이터 조작어임
2. SELECT, INSERT, UPDATE, DELETE

### SELECT

1. 테이블에서 원하는 데이터를 조회할 때 사용하는 키워드
2. 형식
```SQL
SELECT column_name1,column_name2... FROM TABLE_NAME;
SELECT column_name1,column_name2... FROM TABLE_NAME WHERE 조건식;
```

### INSERT

1. 테이블에 데이터를 추가할 때 사용하는 키워드
2. 형식
```SQL
INSERT INTO TABLE_NAME(column_name1, column_name2...) VALUES(값1,값2...) --DEFAULT 쓸 때
INSERT INTO TABLE_NAME VALUES(값1,값2,....) --무조건 만든 컬럼 개수만큼 값을 넣어야함
```

### UPDATE

1. 테이블의 내용을 수정할 때 사용하는 키워드
2. 형식
```SQL
UPDATE TABLE_NAME
SET 기존column_name --= 새로운 값
WHERE 조건식; --조건을 달지 않으면 테이블 전체가 바뀌어 버림
```

### DELETE

1. 삭제 ※TRUNCATE는 다 날려버리는건데 DELETE는 1개씩 지움
2. 형식
```SQL
DELETE FROM TABLE_NAME WHERE 조건식;
```

### WHERE

1. 원하는 자료를 검색하기 위한 조건절
2. WHERE 절에서는 결과를 제한하기 위한 조건을 기술할 수도 있음
3. WHERE절은 조회하려는 데이터에 특정 조건을 부여할 목적으로 사용하기 때문에 FROM절 뒤에 오게 됨
4. 비교 연산자 : 
	- > , < : 초과, 미만
	- >=, <= : 이상, 이하
	- = : 같다
	- < >, !=, **^=** : 같지않음
	- AND : 두 조건식이 모두 참이면 참
	- OR : 둘 중 하나라도 참이면 참
5. 보통은 조건식의 좌측에 위치하지만, 문자/숫자/표현식은 조건식의 우측에 위치함
6. 비교칼럼명은 JOIN과 함께쓰임


