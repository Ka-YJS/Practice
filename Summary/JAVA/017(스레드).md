# 스레드

1. 우리는 컴퓨터로 문서를 작성하면서 동시에 음악을 듣고, 메신저를 사용할 수 있음
2. 이처럼 동시에 두 가지 이상의 작업을 처리하는 것을 '멀티태스킹'이라고 함
3. 컴퓨터에는 멀티태스킹을 위해 '프로세스'와 '스레드'라는 두 가지 도구가 있음
4. 프로스세스 내부에 존재하면서 실행 흐름을 나타내는 것
5. 프로세스
    - 컴퓨터에 저장되어 있는 파일을 실행하는 순간 메모리에 올라가고 동작하게 되는데 이 상태를 프로세스 라고 함
    - 프로세스는 독립적으로 메모리에 등록되므로 여러 개의 프로그램을 동시에 실행할 수 있음
6. 프로세스가 실행되는 방식

## 스레드 동기화(Synchronized)

1. 멀티스레드 프로그램이 실행될 때 다수의 스레드가 하나의 데이터를 공유하면서 스레드간의 경쟁이 일어날 수 있음
2. 경쟁이 정상적으로 이루어진다면 문제가 없겠지만, 간혹 스레드 사이에서 자원 소유의 순서가 잘못되어 예상치 못한 결과가 나타날 수도 있음
3. Bank에서 나온 오류를 방지하기위해 여러 스레드가 하나의 공유데이터에 동시에 접근하지 못하도록
스레드의 실행을 제어하는 '스레드 동기화'가 필요함
4. 스레드 동기화 처리
    - 하나의 스레드가 이 영역에 진입할 때 락을 걸어 다른 스레드가 수행되지 못하도록 하고, 작업이 종료되면 락을 풀어 다른 스레드가 작업하도록 하는 것임
    - 블록 또는 메서드 단위로 synchronized키워드를 붙여 사용함
5. 메서드 동기화 처리
    - 메서드 이름 앞에 synchronized키워드를 사용하면 해당 메서드 전체를 동기화처리할 수 있음
    - 형식
    ```java
    public synchronized void add( ){...}
    ```
6. 블록 메서드 처리
    - 메서드 동기화 처리 :  메서드 처리 시간이 길어질 경우 성능에 영향을 미치는 단점이 있음
    - 이러한 이유로 전체 메서드가 아닌 특정 영역만 동기화 처리를 하는 것을 블록동기화 처리라고 함
    - 형식
    ```java
    sychronized(객체명);
    ```

## 스레드 상태

1. 스레드는 생성하고 실행, 종료되기까지 다양한 상태를 가짐
2. 각 스레드의 상태는 스레드 클래스에 정의되어 있으며, Thread.State 타입으로 알 수 있음
3. 스레드 상태에 따라 6개의 타입으로 분류하고 있음
4. 스레드의 상태

|상태|상수|설명|
|---|---|---|
|생성|NEW|스레드 객체가 생성되었지만 아직 start( )메서드가 호출되지 않은 상태|
|대기|RUNNABLE|실행 대기 또는 실행 상태로 언제든지 갈 수 있는 상태|
|일시정지|WATING|다른 스레드가 종료될 때까지 대기하는 상태|
||TIMED_WATING|주어진 시간동안 대기하는 상태|
|종료|BLOCKED|락이 풀릴 때까지 대기하는 상태|
||TERMINATED|수행을 종료한 상태|

5. New와 RUNNABLE,TERMINATED
    - 처음 스레드가 생성되면 스레드는 NEW 상태가 됨
    - 생성 이후에 start( ) 메서드를 실행하면 스레드는 RUNNBLE 상태로 변함
    - 시작 이후에 스레드가 종료되면 TERMINATED상태가 됨
6. WAIT
    - 스레드 WAIT 상태는 필요에 의해서 스레드를 잠시 멈춤 상태로 두는 것임
    - 스레드를 잠시 멈춤 상태로 만들 때는 일정 시간을 지정하거나, 멈춤 상태의 락이 풀릴 때까지 대기하도록 만들 수 있음

## 상태변화 메서드

1. 

|메서드|설명|
|---|---|
|static void sleep(long millis)|millisecond에 지정된 시간만큼 대기|
|void join( )|현재 스레드는 join()메서드를 호출한 스레드가 종료할 때까지 대기|
|static void yield( )|수행중인 스레드 중 우선순위가 같은 스레드에게 제어권을 넘김|

2. sleep( )메서드
    - sleep(int mils)메서드는 주어진 시간 동안 스레드를 정지시키는 메서드임
    - 해당 기능은 모든 스레드를 대기시켜주며, 주어진 시간이 지나면 풀리게 됨

## wait( )와 notify( )

1. 여러 개의 스레드가 동시에 동작하다 보면, 하나의 스레드가 완료되어야 다음 스레드가 동작할 수 있는 경우가 있음
2. 예시 : 
    - 한쪽에서는 물건을 나르고, 다른 한쪽에서는 물건을 쌓는 스레드가 있다고 가정함
    - 만약 쌓을 물건이 없다면 물건을 나르는 스레드는 할일이 없어짐
    - 이때, 물건을 나르는 스레드를 잠시 중지시키고, 물건이 오면 다시 나르도록 할 수 있음
3. wait( )메서드는 스레드를 대기시키고, notify( )메서드는 대기중인 스레드를 다시 동작시킬 때 사용
4. 두 개 이상의 스레드가 구동중일 때 한 개의 동기화 스레드가 작업을 완전히 마칠때까지 기다렸다가 다른 스레드의 작업이 수행되는 것이 아니라 동기화 진행중에 일시적으로 스레드를 정지시키고 다른 스레드가 작업을 할 수 있음